<?xml version="1.0" encoding="UTF-8"?> 
<databaseChangeLog 
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd"> 
    <changeSet author='tkopacki' id='velocity-template-table'>
        <sql>    
            CREATE TABLE IF NOT EXISTS `template` (
            `id` int(11) NOT NULL AUTO_INCREMENT,
            `name` varchar(45) COLLATE utf8_polish_ci NOT NULL,
            `source` text COLLATE utf8_polish_ci,
            PRIMARY KEY (`id`),
            UNIQUE KEY `name_UNIQUE` (`name`)
            ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_polish_ci AUTO_INCREMENT=1 ;
        </sql>
    </changeSet>
    <changeSet author='tkopacki' id='velocity-template-variables-table'>
        <sql>    
            CREATE TABLE IF NOT EXISTS `template_variables` (
            `id` int(11) NOT NULL AUTO_INCREMENT,
            `template_id` int(11) NOT NULL,
            `name` varchar(45) COLLATE utf8_polish_ci NOT NULL,
            `data` varchar(255) COLLATE utf8_polish_ci NOT NULL,
            PRIMARY KEY (`id`),
            UNIQUE KEY `name_UNIQUE` (`name`)
            ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_polish_ci AUTO_INCREMENT=1 ;
        </sql>
    </changeSet>
    <changeSet author='tkopacki' id='velocity-template-variable-fkey'>
        <sql> 
            ALTER TABLE `template_variables`
            ADD CONSTRAINT `template_variables_fkey` FOREIGN KEY (`template_id`) REFERENCES `address` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;
        </sql>
    </changeSet>
</databaseChangeLog>