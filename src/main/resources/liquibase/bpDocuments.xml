<?xml version="1.0" encoding="UTF-8"?> 
<databaseChangeLog 
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd"> 

    <changeSet author='tkopacki' id='bp-documents-tables'>
        <sql>  
            CREATE TABLE IF NOT EXISTS `incoming_payment_document` (
            `id` int(11) NOT NULL AUTO_INCREMENT,
            `sender` varchar(255) COLLATE utf8_polish_ci DEFAULT NULL,
            `dateFrom` date DEFAULT NULL,
            `dateTo` date DEFAULT NULL,
            `accountNumber` varchar(255) COLLATE utf8_polish_ci DEFAULT NULL,
            `extractNumber` varchar(255) COLLATE utf8_polish_ci DEFAULT NULL,
            `income` decimal(10,2) DEFAULT NULL,
            `spending` decimal(10,2) DEFAULT NULL,
            `positionCounter` int(11) DEFAULT NULL,
            `status` varchar(255) COLLATE utf8_polish_c NOT NULL,
            `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
            PRIMARY KEY (`id`),
            KEY `incoming_payment_document_status` (`status_id`)
            ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_polish_ci AUTO_INCREMENT=14 ;

            CREATE TABLE IF NOT EXISTS `incoming_payment_document_position` (
            `id` int(11) NOT NULL AUTO_INCREMENT,
            `positionNo` int(11) DEFAULT NULL,
            `income` decimal(10,3) DEFAULT NULL,
            `clientNumber` varchar(255) COLLATE utf8_polish_ci DEFAULT NULL,
            `requestDate` date DEFAULT NULL,
            `bookingDate` date DEFAULT NULL,
            `title` varchar(255) COLLATE utf8_polish_ci DEFAULT NULL,
            `clientName` varchar(255) COLLATE utf8_polish_ci DEFAULT NULL,
            `clientAddress` varchar(255) COLLATE utf8_polish_ci DEFAULT NULL,
            `clientAccountNumber` varchar(255) COLLATE utf8_polish_ci DEFAULT NULL,
            `document_id` int(11) NOT NULL,
            PRIMARY KEY (`id`),
            KEY `incoming_payment_document_position_fkey` (`document_id`)
            ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_polish_ci AUTO_INCREMENT=3 ;

            ALTER TABLE `incoming_payment_document`
            ADD CONSTRAINT `incoming_payment_document_status` FOREIGN KEY (`status`) REFERENCES `dictionary` (`key`) ON DELETE NO ACTION ON UPDATE NO ACTION;

            ALTER TABLE `incoming_payment_document_position`
            ADD CONSTRAINT `incoming_payment_document_position_fkey` FOREIGN KEY (`document_id`) REFERENCES `incoming_payment_document` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;
        </sql>
    </changeSet>
</databaseChangeLog>