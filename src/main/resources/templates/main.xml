<?xml version="1.0" encoding="UTF-8"?>
<templates>
    <template>
        <name>menu-structure</name>
        <source>menu-structure.vtl</source>
        <variables>
            <var>
                <name>categories</name>
                <data>SELECT c FROM Category c</data>
            </var>
        </variables>
    </template>
    <template>
        <name>communities-and-possessions-list</name>
        <source>communities-and-possessions-list.vtl</source>
        <variables>
            <var>
                <name>communities</name>
                <data>
                    {:limit}
                    SELECT 
                        community.name, community.area, 
                        possessionAddress.street, possessionAddress.houseNumber, possessionAddress.flatNumber, 
                        possession.area 
                    FROM 
                        Community community 
                        JOIN community.possessions possession 
                        JOIN possession.address possessionAddress
                        JOIN possession.people possessionOwnerPerson
                        JOIN possession.companies possessionOwnerCompany
                        JOIN possessionOwnerPerson.address personAddress
                        JOIN possessionOwnerCompany.address companyAddress
                    WHERE 1=1 {:where}
                </data>
            </var>
            <var>
                <name>countRows</name>
                <data>
                    {:single}
                    SELECT count(c.name)
                    FROM Community c JOIN c.possessions p JOIN p.address pa
                </data>
            </var>
        </variables>
    </template>
</templates>
